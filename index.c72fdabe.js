var t={};class e{static InitialState=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];static InitialStatus={idle:"idle",playing:"playing",win:"win",lose:"lose"};constructor(t=e.InitialState){this.score=0,this.status=e.InitialStatus.idle,this.state=t.map(t=>[...t])}moveLeft(){if("playing"!==this.status)return!1;let t=[[],[],[],[]],e=[[],[],[],[]];for(let e=0;e<4;e++)t[e]=this.state[e].filter(t=>0!==t);for(let e=0;e<4;e++)for(let s=0;s<t[e].length;s++)t[e][s]===t[e][s+1]&&(this.score+=t[e][s],t[e][s]=2*t[e][s],t[e][s+1]=0,s++);for(let s=0;s<4;s++)e[s]=t[s].filter(t=>0!==t);for(let t=0;t<4;t++)for(let s=0;s<4;s++)e[t][s]>0?this.state[t][s]=e[t][s]:e[t][s]||(this.state[t][s]=0);this.boards()}moveRight(){if("playing"!==this.status)return!1;let t=[[],[],[],[]],e=[[],[],[],[]];for(let e=0;e<4;e++)t[e]=this.state[e].filter(t=>0!==t);for(let e=0;e<4;e++)for(let s=0;s<t[e].length;s++)t[e][s]===t[e][s+1]&&(this.score+=t[e][s],t[e][s]=2*t[e][s],t[e][s+1]=0,s++);for(let s=0;s<4;s++)e[s]=t[s].filter(t=>0!==t);for(let t=0;t<4;t++){let s=0,l=3;for(let r=3;r>=0;r--)e[t][r]&&e[t][r]>0?(this.state[t][l]=e[t][r],l--):!e[t][r]&&(this.state[t][s]=0,s++)}this.boards()}moveUp(){if("playing"!==this.status)return!1;let t=[[],[],[],[]];for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[s][e]=this.state[e][s];let e=[[],[],[],[]],s=[[],[],[],[]];for(let s=0;s<4;s++)e[s]=t[s].filter(t=>0!==t);for(let t=0;t<4;t++)for(let s=0;s<e[t].length;s++)e[t][s]===e[t][s+1]&&(this.score+=e[t][s],e[t][s]=2*e[t][s],e[t][s+1]=0,s++);for(let t=0;t<4;t++)s[t]=e[t].filter(t=>0!==t);for(let e=0;e<4;e++)for(let l=0;l<4;l++)s[e][l]>0?t[e][l]=s[e][l]:s[e][l]||(t[e][l]=0);for(let e=0;e<4;e++)for(let s=0;s<4;s++)this.state[e][s]=t[s][e];this.boards()}moveDown(){if("playing"!==this.status)return!1;let t=[[],[],[],[]];for(let e=0;e<4;e++)for(let s=0;s<4;s++)t[s][e]=this.state[e][s];let e=[[],[],[],[]],s=[[],[],[],[]];for(let s=0;s<4;s++)e[s]=t[s].filter(t=>0!==t);for(let t=0;t<4;t++)for(let s=0;s<e[t].length;s++)e[t][s]===e[t][s+1]&&(this.score+=e[t][s],e[t][s]=2*e[t][s],e[t][s+1]=0,s++);for(let t=0;t<4;t++)s[t]=e[t].filter(t=>0!==t);for(let e=0;e<4;e++){let l=0,r=3;for(let a=3;a>=0;a--)s[e][a]&&s[e][a]>0?(t[e][r]=s[e][a],r--):!s[e][a]&&(t[e][l]=0,l++)}for(let e=0;e<4;e++)for(let s=0;s<4;s++)this.state[e][s]=t[s][e];this.boards()}getScore(){return this.score}getStatus(){let t=document.querySelector(".message-win"),e=document.querySelector(".message-lose");"win"===this.status?t.classList.remove("hidden"):"lose"===this.status?e.classList.remove("hidden"):"playing"===this.status&&(t.classList.add("hidden"),e.classList.add("hidden"))}getState(){document.querySelectorAll(".field-cell").forEach((t,e)=>{t.classList.remove(`field-cell--${t.textContent}`),t.textContent=0===this.state.flat()[e]?"":this.state.flat()[e],t.classList.add(`field-cell--${t.textContent}`)}),this.state.flat().includes(0)?this.state.flat().includes(2048)&&(this.status=e.InitialStatus.win):this.status=e.InitialStatus.lose}start(){return this.state=e.InitialState.map(t=>[...t]),this.score=0,this.randomCells(),this.randomCells(),this.status=e.InitialStatus.playing,this.status}restart(){this.score=0,this.state=e.InitialState.map(t=>[...t]),this.getState()}randomCells(){let t=[];this.state.map((e,s)=>{e.map((e,l)=>{0===e&&t.push({indexRow:s,indexCell:l})})});let e=Math.round(Math.random()*(t.length-1));this.state[t[e].indexRow][t[e].indexCell]=.9>Math.random()?2:4}boards(){let t=[];document.querySelectorAll(".field-cell").forEach((e,s)=>{t[s]=""===e.textContent?0:e.textContent}),this.state.flat().toString()!==t.toString()&&this.randomCells()}}const s=new(e&&e.__esModule?e.default:e),l=document.querySelector(".game-score"),r=document.querySelector(".button"),a=document.querySelector(".message-start");r.addEventListener("click",()=>{a.classList.toggle("hidden"),r.classList.toggle("restart"),document.querySelector(".restart")&&(document.querySelector(".restart").textContent="Restart",s.start()),r.classList.toggle("start"),document.querySelector(".start")&&(document.querySelector(".start").textContent="Start",s.restart(),l.textContent=s.getScore()),s.getState()}),document.addEventListener("keydown",t=>{switch(t.key){case"ArrowLeft":s.moveLeft();break;case"ArrowRight":s.moveRight();break;case"ArrowUp":s.moveUp();break;case"ArrowDown":s.moveDown()}l.textContent=s.getScore(),s.getState(),s.getStatus()});
//# sourceMappingURL=index.c72fdabe.js.map
